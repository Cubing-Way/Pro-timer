(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();const ye=new Worker("/Pro-timer/cstimer_module.js?worker_file&type=classic");let X=0;const te={};ye.onmessage=e=>{const[t,,n]=e.data;te[t]?.(n),delete te[t]};function J(e,t=[]){return new Promise(n=>{X++,te[X]=n,ye.postMessage([X,e,t])})}const ce={getScramble:(e,t=0)=>J("scramble",[e,t]),getImage:(e,t)=>J("image",[e,t]),setSeed:e=>J("seed",[e]),setGlobal:(e,t)=>J("set",[e,t])};let Q="";const De={333:["333",0],"333oh":["333",0],"333fm":["333fm",0],222:["222so",0],444:["444wca",0],555:["555wca",60],666:["666wca",80],777:["777wca",100],"333bf":["333ni",0],"444bf":["444bld",40],"555bf":["555bld",60],"333mbf":["r3ni",5],minx:["mgmp",70],pyram:["pyrso",10],skewb:["skbso",0],sq1:["sqrs",0],clock:["clkwca",0]};async function _(e="333",t){const[n,o]=De[e];if(!n)return;const s=await ce.getScramble(n,o),r=await ce.getImage(s,n);Q=s;const i=t;i.innerHTML=r,Ne(e,t);const d=document.getElementById("scrambleDisplay");e==="minx"||e==="megaminx"?d.textContent=Me(s):d.textContent=s,Fe()}function Me(e){const t=e.split(" ");let n=[],o=[];for(const s of t)o.push(s),(s==="U"||s==="U'")&&(n.push(o.join(" ")),o=[]);return o.length&&n.push(o.join(" ")),n.join(`
`)}function Fe(){const e=document.getElementById("scrambleContainer"),t=document.getElementById("scrambleDisplay");let n=40;for(t.style.fontSize=n+"px",t.style.whiteSpace="pre-wrap",t.style.wordBreak="break-word",t.offsetHeight;t.scrollHeight>e.clientHeight;)n-=1,t.style.fontSize=n+"px"}function Ne(e,t){t.id==="scrambleVis"?["333","333bf","333mbf","333oh","333fm"].includes(e)?g(.45,75,70,t):e==="222"?g(.6,-43,-10,t):e==="pyram"?g(.4,55,70,t):["444","444bf"].includes(e)?g(.35,130,110,t):e==="skewb"?g(.4,65,75,t):["555","555"].includes(e)?g(.3,165,135,t):e==="666"?g(.25,180,150,t):e==="777"?g(.22,195,155,t):e==="minx"?g(.5,105,40,t):e==="clock"?g(.5,60,15,t):e==="sq1"&&g(.4,105,55,t):["333","333bf","333mbf","333oh","333fm"].includes(e)?g(.45,75,70,t):e==="222"?g(.6,-43,-10,t):e==="pyram"?g(.4,55,70,t):["444","444bf"].includes(e)?g(.35,130,110,t):e==="skewb"?g(.4,65,75,t):["555","555"].includes(e)?g(.3,165,135,t):e==="666"?g(.25,180,150,t):e==="777"?g(.22,195,155,t):e==="minx"?g(.5,105,40,t):e==="clock"?g(.5,60,15,t):e==="sq1"&&g(.4,105,55,t)}function g(e,t,n,o){let s=null;if(o.id==="scrambleVis"){s=document.querySelector(".panel-cube"),s.style.transformOrigin="bottom right",s.style.transform=`scale(${e})`,s.style.position="absolute",s.style.right=`${t}px`,s.style.bottom=`${n}px`;const r=document.getElementById("scrambleVis"),i=r.width||600,d=r.height||400;s.style.width=i*e+"px",s.style.height=d*e+"px"}else{n+=50,s=document.querySelector(".panel-cube2"),s.style.transformOrigin="bottom center",s.style.transform=`scale(${e})`,s.style.right=`${t}px`,s.style.bottom=`${n}px`;const r=document.getElementById("scrambleVis"),i=r.width||600,d=r.height||400;s.style.width=i*e+"px",s.style.height=d*e+"px"}}const a={timerPhase:0,interval:0,wcaInterval:0,wcaDelayCount:!1,inspecting:!1,inspection:0};function ve(e){a.timerPhase!==1?a.timerPhase++:a.timerPhase===1&&(e==="None"?(B("color","limeGreen"),a.timerPhase++):(B("color","red"),a.wcaInterval=setInterval(()=>{B("color","limeGreen"),a.wcaDelayCount++},300)))}function pe(){a.wcaDelayCount>=1?(a.timerPhase++,a.wcaDelayCount=0,clearInterval(a.wcaInterval)):(B("color","#eaeaf0"),a.wcaDelayCount=0,clearInterval(a.wcaInterval))}let M=0,j=null,G=!1;function ne(){G?(G=!1,clearInterval(j),j=null,M=0,F?B("time",F):B("time","0.00")):(G=!0,B("time",M),j=setInterval(()=>{M++,B("time",M),M===8&&new Audio("./audio/8seconds.mp3").play(),M===12&&new Audio("./audio/12seconds.mp3").play(),M===17&&(G=!1,clearInterval(j),j=null,M=0,F?B("time",F):B("time","0.00"))},1e3))}function he(e){a.inspecting=!0;const t=performance.now();let n=-1;a.interval=setInterval(()=>{const o=performance.now()-t,s=Math.floor(o/1e3),r=o/1e3;a.inspection=parseFloat(r.toFixed(2)),e==="WCA"&&s!==n&&(n=s,s===8&&new Audio("./audio/8seconds.mp3").play(),s===12&&new Audio("./audio/12seconds.mp3").play(),s===17&&clearInterval(a.interval)),B("time",s)},10)}function ee(e){return(Math.floor(e*100)/100).toFixed(2)}function Pe(e){let t=e/1e3,n=Math.floor(t/60),o=Math.floor(n/60);if(n<1)return ee(t);if(n>=1)return t=t-60*n,`${n}: ${t<10?"0":""}${ee(t)}`;if(n>=60)return n=n-60*o,`${o}: ${n<10?"0":""}${n}: ${t<10?"0":""}${ee(t)}`}function be(e){B("color","#eaeaf0"),clearInterval(a.interval),a.inspecting=!1;const t=performance.now();a.interval=setInterval(()=>{B("time",Pe(performance.now()-t))},10)}function Ee(){clearInterval(a.interval),document.getElementById("timer").innerHTML,a.timerPhase=0}const l={mode:"ao5",solveCounter:0,solvesArray:[]},de=JSON.parse(localStorage.getItem("cube_average_buffer"));de&&Object.assign(l,de);function se(e){if(typeof e=="number")return e;if(e.includes(":")){const[t,n]=e.split(":");return parseInt(t,10)*60+parseFloat(n)}return parseFloat(e)}function xe(e){const t=Number(e);return Number.isFinite(t)?t.toFixed(2):"-"}function ue(e){if(e>=60){const t=Math.floor(e/60),n=(e%60).toFixed(2).padStart(5,"0");return`${t}:${n}`}return e.toFixed(2)}function z(e){return e.penalty==="DNF"?"DNF":e.penalty==="+2"?ue(e.time+2)+" (+2)":ue(e.time)}function u(e){if(e==="DNF"||(e=Number(e),!Number.isFinite(e)))return"DNF";if(e>=60){const t=Math.floor(e/60),n=(e%60).toFixed(2).padStart(5,"0");return`${t}:${n}`}return xe(e)}function P(e,t){const n=e.map(m=>m.penalty==="DNF"?1/0:m.penalty==="+2"?m.time+2:m.time);let o=null,s=null;if(t==="bo3"){if(n.filter(y=>y===1/0).length>=2)return{dnf:!0};const c=[...n].sort((y,I)=>y-I);o=c[0],s=c[c.length-1];const v=n.filter(y=>y!==1/0),T=v.reduce((y,I)=>y+I,0)/v.length,D=v.reduce((y,I)=>y+Math.pow(I-T,2),0)/v.length,q=Math.sqrt(D);return{dnf:!1,avg:T,best:o,worst:s,sigma:q}}if(t==="bo5"){if(n.filter(y=>y===1/0).length>=2)return{dnf:!0};const c=[...n].sort((y,I)=>y-I);o=c[0],s=c[c.length-1];const v=n.filter(y=>y!==1/0),T=v.reduce((y,I)=>y+I,0)/v.length,D=v.reduce((y,I)=>y+Math.pow(I-T,2),0)/v.length,q=Math.sqrt(D);return{dnf:!1,avg:T,best:o,worst:s,sigma:q}}if(t==="ao5"){if(n.filter(S=>S===1/0).length>=2)return{dnf:!0};const c=[...n].sort((S,L)=>S-L);o=c[0],s=c[c.length-1];const v=c.slice(1,4);let T=null;v.includes(1/0)?T="DNF":T=v.reduce((S,L)=>S+L,0)/v.length;const D=n.filter(S=>S!==1/0),q=D.reduce((S,L)=>S+L,0)/D.length,y=D.reduce((S,L)=>S+Math.pow(L-q,2),0)/D.length,I=Math.sqrt(y);if(c.length===4){const S=(c[0]+c[1]+c[2])/3,L=(c[3]+c[2]+c[1])/3;return{dnf:!1,avg:T,best:o,worst:s,sigma:I,bpAo5:S,wpA05:L}}return{dnf:!1,avg:T,best:o,worst:s,sigma:I}}if(n.filter(m=>m===1/0).length>=1)return{dnf:!0};const i=n.reduce((m,c)=>m+c,0)/n.length,d=n.reduce((m,c)=>m+Math.pow(c-i,2),0)/n.length,h=Math.sqrt(d);return o=Math.min(...n),s=Math.max(...n),{dnf:!1,avg:i,best:o,worst:s,sigma:h}}function oe(e,t,n,o){let s=null;o==="WCA"&&(n>=15?s="+2":n>=17&&(s="DNF"));const r=se(e);l.solvesArray.push({time:r,penalty:s||null,scramble:t,inspection:n,createdAt:Date.now()}),l.solveCounter++;let i=3;if((l.mode==="ao5"||l.mode==="bo5")&&(i=5),l.solveCounter===i){const d=P(l.solvesArray,l.mode),h={mode:l.mode,average:d.avg==="DNF"?"DNF":u(d.avg),worst:u(d.worst),best:u(d.best),sigma:u(d.sigma),solves:structuredClone(l.solvesArray)};return l.solvesArray=[],l.solveCounter=0,h}return localStorage.setItem("cube_average_buffer",JSON.stringify(l)),null}const f={sessions:JSON.parse(localStorage.getItem("sessions"))||{Default:{averages:[]}},currentSession:localStorage.getItem("currentSession")||"Default",selectEl:document.getElementById("sessionSelect")},Oe=E();l.mode=Oe.mode||"ao5";const me=document.getElementById("modeSelect");me&&(me.value=l.mode);function w(){localStorage.setItem("sessions",JSON.stringify(f.sessions)),localStorage.setItem("currentSession",f.currentSession)}function E(){return f.sessions[f.currentSession]||(f.sessions[f.currentSession]={averages:[]}),f.sessions[f.currentSession]}function x(){const e=f.selectEl;e.innerHTML="",Object.keys(f.sessions).forEach(n=>{const o=document.createElement("option");o.value=n,o.textContent=n,n===f.currentSession&&(o.selected=!0),e.appendChild(o)});const t=document.createElement("option");t.disabled=!0,t.textContent="â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€",e.appendChild(t),e.appendChild(new Option("âž• New session...","__new__")),e.appendChild(new Option("âœ Rename current...","__rename__")),e.appendChild(new Option("ðŸ—‘ Delete current...","__delete__"))}function K(e){f.currentSession=e,w(),x(),document.dispatchEvent(new CustomEvent("sessionChanged"))}f.selectEl.onchange=()=>{const e=f.selectEl.value;if(e==="__new__"){const t=prompt("New session name:");if(!t||f.sessions[t]){x();return}f.sessions[t]={averages:[]},K(t);return}if(e==="__rename__"){const t=f.currentSession,n=prompt("Rename session:",t);if(!n||n===t||f.sessions[n]){x();return}f.sessions[n]=f.sessions[t],delete f.sessions[t],K(n);return}if(e==="__delete__"){if(Object.keys(f.sessions).length===1){alert("You must have at least one session."),x();return}if(!confirm("Delete current session?")){x();return}delete f.sessions[f.currentSession];const t=Object.keys(f.sessions)[0];K(t);return}K(e)};x();function _e(){confirm("Delete all averages in this session?")&&(Ve(),l.solvesArray=[],l.scramblesArray=[],l.solveCounter=0)}function He(){const e=E();l.mode=e.mode||"ao5";const t=document.getElementById("modeSelect");t&&(t.value=l.mode),l.solvesArray=[],l.scramblesArray=[],l.solveCounter=0}const C=document.getElementById("detailsModal"),ke=document.getElementById("modalBody"),qe=document.getElementById("closeModalBtn");qe.onclick=()=>C.classList.add("hidden");C.onclick=e=>{e.target===C&&C.classList.add("hidden")};function re(){const e=U();let t='<h3 class="modal-title">Session averages</h3>';e.forEach((n,o)=>{let s=`${n.mode} #${e.length-o}: ${n.average}`;if(n.mode==="bo3"){const r=P(n.solves,"mo3"),i=r.avg==="DNF"?"DNF":u(r.avg);s=`${n.mode} #${e.length-o}: ${n.average} (mo3: ${i})`}else if(n.mode==="bo5"){const r=P(n.solves,"ao5"),i=r.avg==="DNF"?"DNF":u(r.avg);s=`${n.mode} #${e.length-o}: ${n.average} (ao5: ${i})`}t+=`
            <div class="modal-average-card">
                <div class="modal-average-header">
                    <b>${s}</b>
                </div>

                <div class="modal-solves">
        `,n.solves.forEach((r,i)=>{t+=`
                <div class="modal-solve-row">
                    <div class="modal-solve-main">
                        <span>#${i+1}: ${z(r)}</span>

                        <div class="modal-solve-actions">
                            <button onclick="setPenalty(${o}, ${i}, null)">OK</button>
                            <button onclick="setPenalty(${o}, ${i}, '+2')">+2</button>
                            <button onclick="setPenalty(${o}, ${i}, 'DNF')">DNF</button>
                            <button onclick="removeSolve(${o}, ${i})">âœ–</button>
                        </div>
                    </div>

                    <div class="modal-scramble">
                        ${n.solves[i].scramble}
                    </div>
                </div>
            `}),t+=`
                </div>
            </div>
        `}),ke.innerHTML=t,C.classList.remove("hidden")}function je(){const e=E();e.averages||(e.averages=[])}function ie(e){je(),E().averages.unshift(e),w()}function Ve(){const e=E();e.averages=[],w()}function U(){return E().averages||[]}function Ie(){if(l.solvesArray.length>0)return{type:"current",solveIndex:l.solvesArray.length-1};const e=U();if(e.length===0)return null;const t=0,n=e[0];return!n||n.solves.length===0?null:{type:"saved",blockIndex:t,solveIndex:n.solves.length-1}}function We(e,t,n){const s=U()[e];s.solves[t].penalty=n;const r=P(s.solves,s.mode).avg;s.average=r==="DNF"?"DNF":u(r),w()}function ze(e,t){const n=U();if(e===-1){if(t<0||t>=l.solvesArray.length)return;l.solvesArray.splice(t,1),l.solveCounter--,l.solveCounter<0&&(l.solveCounter=0);return}const o=n[e];if(e===0&&l.solvesArray.length===0){const r=o.solves.filter((i,d)=>d!==t);l.solvesArray=structuredClone(r),l.solveCounter=r.length,n.splice(e,1),C.classList.add("hidden"),w();return}if(confirm(`This solve belongs to a finished average.

OK = Replace this solve (reopen average)
Cancel = Delete the whole average`)){const r=o.solves.filter((i,d)=>d!==t);l.solvesArray=structuredClone(r),l.solveCounter=r.length,n.splice(e,1),C.classList.add("hidden"),w();return}confirm("Delete the entire average? This cannot be undone.")&&(n.splice(e,1),w())}function le(e){const t=Ie();t&&(t.type==="current"?l.solvesArray[t.solveIndex].penalty=e:window.setPenalty(t.blockIndex,t.solveIndex,e))}function Re(){const e=Ie();e&&(e.type==="current"?window.removeSolve(-1,e.solveIndex,!0):window.removeSolve(e.blockIndex,e.solveIndex,!0))}const Ue=-180,Z=Ue*60*1e3;function Je(e=Date.now()){const t=new Date(e+Z);return t.setUTCHours(0,0,0,0),t.getTime()-Z}function Ge(e=Date.now()){const t=new Date(e+Z);return t.setUTCHours(23,59,59,999),t.getTime()-Z}function Se(e){const t=[];return e.averages.forEach(n=>{n.solves.forEach(o=>{t.push(o)})}),l.solvesArray.forEach(n=>t.push(n)),t}function Be(e,t){let n=[],o=[],s=0;if(t.averages.forEach(c=>{c.average!=="DNF"&&o.push(se(c.average))}),e.forEach(c=>{c.penalty===null?(n.push(c.time),s++):(c.penalty==="+2"&&n.push(c.time+2),s++)}),n.length===0)return{bestTime:0,mean:0,sigma:0,bestAvg:0,solveCounter:s};const r=o.length?Math.min(...o):0,i=Math.min(...n),d=n.reduce((c,v)=>c+v,0)/n.length,h=n.reduce((c,v)=>c+Math.pow(v-d,2),0)/n.length,m=Math.sqrt(h);return{bestTime:i,mean:d,sigma:m,bestAvg:r,solveCounter:s}}function Ke(e,t){const n=Date.now();let o,s;return o=Je(n),s=Ge(n),e.filter(r=>r.createdAt>=o&&r.createdAt<=s)}function we(){const e=E(),t=Se(e);return Be(t,e)}function Ze(e){const t=E(),n=Se(t),o=Ke(n);return Be(o,t)}function Ye(){const e=we();document.getElementById("stat-solves").textContent=e.solveCounter,document.getElementById("stat-best-time").textContent=u(e.bestTime),document.getElementById("stat-mean").textContent=u(e.mean),document.getElementById("stat-sigma").textContent=u(e.sigma),document.getElementById("stat-best-avg").textContent=u(e.bestAvg);const t=E(),n=document.getElementById("avg-table-head"),o=document.getElementById("avg-history-body");n.innerHTML="",o.innerHTML="";let s=0;t.averages.forEach(i=>{i.solves.length>s&&(s=i.solves.length)});let r=`<tr>
  <th>#</th>
  <th>Type</th>
  <th>Avg</th>
  <th>Best</th>
  <th>Worst</th>

`;for(let i=0;i<s;i++)r+=`<th>${i+1}</th>`;r+="  <th>Ïƒ</th></tr>",n.innerHTML=r,t.averages.forEach((i,d)=>{const h=document.createElement("tr");i.mode==="bo3"||i.mode;let m=`
      <td>${t.averages.length-d}</td>
      <td>${i.mode.toUpperCase()}</td>
      <td>${i.average}</td>
      <td><strong>${i.best}</strong></td>
      <td>${i.worst}</td>

    `;i.solves.forEach(c=>{m+=`<td>${z(c)}</td>`}),m+=`<td>${i.sigma}</td>`,h.innerHTML=m,o.appendChild(h)})}function Qe(e,t){let n="";return e==="live"&&(n+=`
            <div class="history-average current-average">
                <div class="history-solves">
        `,l.solvesArray.forEach((o,s)=>{n+=`
                <div class="history-solve">
                    ${s+1} - ${z(o)}
                </div>
            `}),n+=`
                </div>
            </div>
        `),e==="saved"&&t&&(n+=`
            <div class="history-average current-average">
                <div class="history-solves">
        `,t.solves.forEach((o,s)=>{n+=`
                <div class="history-solve">
                    ${s+1} - ${z(o)}
                </div>
            `}),n+=`
                </div>
            </div>
        `),n}function Xe(e,t){F&&A&&(document.getElementById("timer").textContent=F);let n="";for(let o=0;o<e.length;o++){const s=e[o];if(t==="saved"&&o===0)continue;let r=`${s.mode}: ${s.average}`;if(s.mode==="bo3"){const i=P(s.solves,"mo3"),d=i.avg==="DNF"?"DNF":u(i.avg);r=`${s.mode}: ${s.average} (mo3: ${d})`}else if(s.mode==="bo5"){const i=P(s.solves,"ao5"),d=i.avg==="DNF"?"DNF":u(i.avg);r=`${s.mode}: ${s.average} (ao5: ${d})`}n+=`
            <div class="history-block history-average">
                <div class="history-solves">
        `,s.solves.forEach((i,d)=>{n+=`
                <div class="history-solve">
                    ${d+1} - ${z(i)}
                </div>
            `}),n+=`
                </div>
                <div class="history-title">
                    ${r}
                </div>
            </div>
        `}return n}function fe(e){return`
        Best single: ${e.bestTime!==1/0?u(e.bestTime):"-"}
        <br>
        Best ao5: ${e.bestAvg!==1/0?u(e.bestAvg):"-"}
        <br>
        Session Mean: ${e.mean?u(e.mean):"-"}
        <br>
        Session &sigma;: ${e.sigma?u(e.sigma):"-"}
        <br>
        Solves: ${e.solveCounter?e.solveCounter:"-"}
    `}function et({type:e,solves:t,mode:n,block:o}){if(e==="live"){if(!t||t.length===0)return"";const s=P(t,n),r=s.best,i=s.worst,d=s.sigma,h=s.bpAo5,m=s.wpA05;return t.length===4&&n==="ao5"?`                
                Best: ${u(r)}
                <br>
                Worst: ${u(i)}
                <br>
                &sigma;: ${u(d)}
                <hr>
                bpAo5: ${u(h)}
                <br>
                wpAo5: ${u(m)}
            `:`                
            Best: ${u(r)}
            <br>
            Worst: ${u(i)}
            <br>
            &sigma;: ${u(d)}
        `}return e==="saved"&&o?`                
            Best: ${o.best}
            <br>
            Worst: ${o.worst}
            <br>
            &sigma;: ${o.sigma}
            <hr>
            ${o.mode}: ${o.average}
        `:""}function $(){const e=U(),t=we(),n=Ze(),o=document.getElementById("currentAverageValue"),s=document.getElementById("historyPanel"),r=document.getElementById("current-stats"),i=document.getElementById("stats"),d=document.getElementById("today-stats");let h=null,m=null;l.solvesArray.length>0?h="live":e.length>0&&(h="saved",m=e[0]),o&&(o.innerHTML=Qe(h,m)),r&&(r.innerHTML=et({type:h,solves:l.solvesArray,mode:l.mode,block:m})),s&&(s.innerHTML=Xe(e,h)),i&&(i.innerHTML=fe(t),d.innerHTML=fe(n))}function H(e,t){const n=document.getElementById(e),o=document.querySelectorAll(`.${t}`);if(!n||!o)return;function s(){o.forEach(r=>{r.style.display=n.value==="show"?"":"none"})}n.addEventListener("change",s),s()}H("toggle-scramble-visualizer","panel-cube");H("toggle-statistics","right-sidebar");H("toggle-session-history","left-sidebar");H("toggle-scramble-text","scramble-container");H("toggle-penalty-bar","penalty-bar");H("toggle-average-preview","main-footer");let p=localStorage.getItem("inspectionType")||"WCA",V=p;document.getElementById("inspection-type").value=p;document.getElementById("inspection-type").addEventListener("change",()=>{V=p,p=document.getElementById("inspection-type").value,localStorage.setItem("inspectionType",p)});let R=localStorage.getItem("delayFlagType")||"WCA";document.getElementById("delay-flag").value=R;document.getElementById("delay-flag").addEventListener("change",()=>{R=document.getElementById("delay-flag").value,localStorage.setItem("delayFlagType",R)});let O=localStorage.getItem("timeInsertion")||"Timer",A=!1;O==="Typing"?A=!0:A=!1;document.getElementById("time-insertion").value=O;document.getElementById("time-insertion").addEventListener("change",()=>{O=document.getElementById("time-insertion").value,O==="Typing"?A=!0:A=!1,localStorage.setItem("timeInsertion",O),$e()});function $e(){const e=document.getElementById("typing-container");if(e)if(O==="Typing"){e.style.display="block";const t=document.getElementById("typed-time");t&&t.focus()}else e.style.display="none"}let F=null;document.addEventListener("DOMContentLoaded",()=>{$e();const e=document.getElementById("typed-time-add"),t=document.getElementById("typed-time");document.getElementById("inspection-leave-btn"),e&&t&&(e.addEventListener("click",()=>{const n=t.value.trim().replace(",",".");if(!n)return;const o=se(n);if(!Number.isFinite(o)){t.style.border="2px solid #e74c3c",t.focus(),setTimeout(()=>t.style.border="",1500);return}F=u(o),document.getElementById("timer").textContent=F;const s=oe(o,Q,a.inspection,p);s&&ie(s),$(),_(b,N),t.value=""}),t.addEventListener("keydown",n=>{n.key==="Enter"&&(n.preventDefault(),e.click())}))});const Te=document.getElementById("settingsOverlay"),tt=document.getElementById("settingsBtn"),nt=document.getElementById("closeSettings");tt.addEventListener("click",()=>{Te.classList.add("open")});nt.addEventListener("click",()=>{Te.classList.remove("open")});const Y=document.getElementById("eventSelect");let b=E().scrambleType||"333",N=null;window.innerWidth>768?N=document.querySelector("#scrambleVis"):N=document.querySelector("#scrambleVis2");const st=E();b=st.scrambleType||"333";Y.value=b;ae(b);_(b,N);Y.addEventListener("change",()=>{const e=E();b=Y.value,e.scrambleType=b,w(),ae(b),b.includes("bf")?(V=p,p="None",document.getElementById("inspection-type").value="None",localStorage.setItem("inspectionType","None")):(p=V,document.getElementById("inspection-type").value=V,localStorage.setItem("inspectionType",V)),_(b,N)});document.addEventListener("sessionChanged",()=>{b=E().scrambleType||"333",Y.value=b,ae(b),_(b,N)});function B(e,t){e==="color"?document.getElementById("timer").style.color=t:e==="time"&&(document.getElementById("timer").textContent=t)}function Ae(){const e=document.getElementById("timer"),t=document.getElementById("touchOverlay");if(!e||!t)return;function n(o){o===e||o===t||(o.contains(e)?[...o.children].forEach(n):o.classList.add("focus-hidden"))}n(document.body)}function Le(){document.querySelectorAll(".focus-hidden").forEach(e=>{e.classList.remove("focus-hidden")})}let W=!1;document.getElementById("touchOverlay").addEventListener("touchstart",e=>{const t=e.target;if(!(t&&t.closest&&(t.closest("input")||t.closest("#typing-container")))&&(e.preventDefault(),!(e.repeat||A))){if(W){document.querySelector(".panel-cube2").style.display="none",document.getElementById("scramble-button").style.justifySelf="center",document.getElementById("scramble-button").innerHTML="Scramble visualizer",W=!1;return}if(a.timerPhase===0&&p==="None"&&(a.timerPhase=1),ve(R),a.timerPhase===1&&!a.inspecting&&p!=="None"&&he(p),a.timerPhase===3){Ee();const n=oe(document.getElementById("timer").innerHTML,Q,a.inspection,p);n&&ie(n),$(),_(b,N),Le()}}});document.getElementById("touchOverlay").addEventListener("touchend",e=>{const t=e.target;t&&t.closest&&(t.closest("input")||t.closest("#typing-container"))||(e.preventDefault(),!e.repeat&&(a.timerPhase===1&&pe(),a.timerPhase===2&&(be(),Ae())))});document.getElementById("touchOverlay").addEventListener("touchstart",()=>{A&&ne()});document.getElementById("inspection-btn").addEventListener("click",()=>{A&&ne()});document.addEventListener("keydown",e=>{A&&(e.code!=="Space"||e.repeat||ne())});document.addEventListener("keydown",e=>{if(e.key===" "){if(e.preventDefault(),e.repeat||A)return;a.timerPhase===0&&p==="None"&&(a.timerPhase=1),ve(R)}if(e.key===" "&&a.timerPhase===1&&!a.inspecting&&p!=="None"&&he(p),e.key===" "&&a.timerPhase===3){Ee();const t=oe(document.getElementById("timer").innerHTML,Q,a.inspection,p);t&&(ie(t),console.log(t)),$(),_(b,N),Le()}});document.addEventListener("keyup",e=>{e.key===" "&&(e.preventDefault(),!e.repeat&&(a.timerPhase===1&&pe(),a.timerPhase===2&&(be(),Ae())))});const Ce=document.getElementById("stats-page"),ot=document.getElementById("open-stats-btn"),rt=document.getElementById("close-stats-btn");ot.addEventListener("click",()=>{Ye(),Ce.classList.add("open")});rt.addEventListener("click",()=>{Ce.classList.remove("open")});function ae(e){const t=E(),n=it(e);if(l.mode!==n){l.mode=n,t.mode=n;const o=document.getElementById("modeSelect");o&&(o.value=n),l.solvesArray=[],l.solveCounter=0,w()}}function it(e){return e==="333bf"?"bo5":e==="444bf"||e==="555bf"?"bo3":["666","777"].includes(e)?"mo3":"ao5"}const ge=document.getElementById("modeSelect");ge&&ge.addEventListener("change",e=>{const t=e.target.value,n=E();l.mode=t,n.mode=t,w(),$()});document.getElementById("scramble-button").addEventListener("click",()=>{if(W){document.querySelector(".panel-cube2").style.display="none",document.getElementById("scramble-button").innerHTML="Scramble visualizer",document.getElementById("scramble-button").style.justifySelf="center",W=!1;return}W=!0,document.querySelector(".panel-cube2").style.display="grid",document.getElementById("scramble-button").style.justifySelf="left",document.getElementById("scramble-button").innerHTML="close"});const k={modeSelect:document.getElementById("modeSelect"),clearBtn:document.getElementById("clearBtn"),openSessionBtn:document.getElementById("modal-button"),penaltyOkBtn:document.getElementById("penaltyOkBtn"),penaltyPlus2Btn:document.getElementById("penaltyPlus2Btn"),penaltyDnfBtn:document.getElementById("penaltyDnfBtn"),removeLastBtn:document.getElementById("removeLastBtn")};document.querySelectorAll("button").forEach(e=>{e.addEventListener("click",()=>{e.blur()})});document.querySelectorAll("select").forEach(e=>{e.addEventListener("change",()=>{e.blur()})});window.setPenalty=function(e,t,n){We(e,t,n),w(),$(),C.classList.contains("hidden")||re()};window.removeSolve=function(e,t){ze(e,t),w(),$(),C.classList.contains("hidden")||re()};document.addEventListener("sessionChanged",()=>{He(),$()});k.clearBtn.onclick=()=>{_e(),$()};k.openSessionBtn.onclick=re;k.penaltyOkBtn.onclick=()=>{le(null),$()};k.penaltyPlus2Btn.onclick=()=>{le("+2"),$()};k.penaltyDnfBtn.onclick=()=>{le("DNF"),$()};k.removeLastBtn.onclick=()=>Re();$();
