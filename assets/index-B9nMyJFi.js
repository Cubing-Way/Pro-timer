(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();const ke=new Worker("/Pro-timer/cstimer_module.js?worker_file&type=classic");let ve=0;const he={};ke.onmessage=e=>{const[n,,o]=e.data;he[n]?.(o),delete he[n]};function ie(e,n=[]){return new Promise(o=>{ve++,he[ve]=o,ke.postMessage([ve,e,n])})}const Ne={getScramble:(e,n=0)=>ie("scramble",[e,n]),getImage:(e,n)=>ie("image",[e,n]),setSeed:e=>ie("seed",[e]),setGlobal:(e,n)=>ie("set",[e,n])},Ue=[["WCA",[["3x3x3","333",0],["2x2x2","222so",0],["4x4x4","444wca",0],["5x5x5","555wca",60],["6x6x6","666wca",80],["7x7x7","777wca",100],["3x3 bld","333ni",0],["3x3 fm","333fm",0],["3x3 oh","333oh",0],["clock","clkwca",0],["megaminx","mgmp",70],["pyraminx","pyrso",10],["skewb","skbso",0],["sq1","sqrs",0],["4x4 bld","444bld",40],["5x5 bld","555bld",60],["3x3 mbld","r3ni",5]]],["===WCA===",[["--","blank",0]]],["3x3x3",[["random state (WCA)","333",0],["random move","333o",25],["edges only","edges",0],["corners only","corners",0],["3x3 ft","333ft",0]]],["3x3x3 CFOP",[["PLL","pll",0],["OLL","oll",0],["last slot + last layer","lsll2",0],["last layer","ll",0],["ZBLL","zbll",0],["COLL","coll",0],["CLL","cll",0],["ELL","ell",0],["2GLL","2gll",0],["ZZLL","zzll",0],["ZBLS","zbls",0],["EOLS","eols",0],["WVLS","wvls",0],["VLS","vls",0],["cross solved","f2l",0],["EOLine","eoline",0],["easy cross","easyc",3],["easy xcross","easyxc",4]]],["3x3x3 Roux",[["2nd Block","sbrx",0],["CMLL","cmll",0],["LSE","lse",0],["LSE &lt;M, U&gt;","lsemu",0]]],["3x3x3 Mehta",[["3QB","mt3qb",0],["EOLE","mteole",0],["TDR","mttdr",0],["6CP","mt6cp",0],["CDRLL","mtcdrll",0],["L5EP","mtl5ep",0],["TTLL","ttll",0]]],["2x2x2",[["random state (WCA)","222so",0],["optimal","222o",0],["3-gen","2223",25],["EG","222eg",0],["CLL","222eg0",0],["EG1","222eg1",0],["EG2","222eg2",0],["TCLL+","222tcp",0],["TCLL-","222tcn",0],["TCLL","222tc",0],["LS","222lsall",0],["No Bar","222nb",0]]],["4x4x4",[["WCA","444wca",-40],["random move","444m",40],["SiGN","444",40],["YJ","444yj",40],["4x4x4 edges","4edge",0],["R,r,U,u","RrUu",40],["Last layer","444ll",0],["ELL","444ell",0],["Edge only","444edo",0],["Center only","444cto",0]]],["4x4x4 Yau/Hoya",[["UD center solved","444ctud",0],["UD+3E solved","444ud3c",0],["Last 8 dedges","444l8e",0],["RL center solved","444ctrl",0],["RLDX center solved","444rlda",0],["RLDX cross solved","444rlca",0]]],["5x5x5",[["WCA","555wca",60],["SiGN","555",60],["5x5x5 edges","5edge",8]]],["6x6x6",[["WCA","666wca",80],["SiGN","666si",80],["prefix","666p",80],["suffix","666s",80],["6x6x6 edges","6edge",8]]],["7x7x7",[["WCA","777wca",100],["SiGN","777si",100],["prefix","777p",100],["suffix","777s",100],["7x7x7 edges","7edge",8]]],["Clock",[["WCA","clkwca",0],["wca (old)","clkwcab",0],["WCA w/o y2","clknf",0],["jaap","clk",0],["optimal","clko",0],["concise","clkc",0],["efficient pin order","clke",0]]],["Megaminx",[["WCA","mgmp",70],["Carrot","mgmc",70],["old style","mgmo",70],["2-generator R,U","minx2g",30],["last slot + last layer","mlsll",0],["PLL","mgmpll",0],["Last Layer","mgmll",0]]],["Pyraminx",[["random state (WCA)","pyrso",10],["optimal","pyro",0],["random move","pyrm",25],["L4E","pyrl4e",0],["4 tips","pyr4c",0],["No bar","pyrnb",0]]],["Skewb",[["random state (WCA)","skbso",0],["optimal","skbo",0],["random move","skb",25],["No bar","skbnb",0]]],["Square-1",[["random state (WCA)","sqrs",0],["CSP","sqrcsp",0],["PLL","sq1pll",0],["face turn metric","sq1h",40],["twist metric","sq1t",20]]],["===OTHER===",[["--","blank",0]]],["15 puzzle",[["random state URLD","15prp",0],["random state ^<>v","15prap",0],["random state Blank","15prmp",0],["random move URLD","15p",80],["random move ^<>v","15pat",80],["random move Blank","15pm",80]]],["8 puzzle",[["random state URLD","8prp",0],["random state ^<>v","8prap",0],["random state Blank","8prmp",0]]],["LxMxN",[["1x3x3 (Floppy Cube)","133",0],["2x2x3 (Tower Cube)","223",0],["2x3x3 (Domino)","233",25],["3x3x4","334",40],["3x3x5","335",25],["3x3x6","336",40],["3x3x7","337",40],["8x8x8","888",120],["9x9x9","999",120],["10x10x10","101010",120],["11x11x11","111111",120],["NxNxN","cubennn",12]]],["Gear Cube",[["random state","gearso",0],["optimal","gearo",0],["random move","gear",10]]],["Kilominx",[["random state","klmso",0],["Pochmann","klmp",30]]],["Gigaminx",[["Pochmann","giga",300]]],["Crazy Puzzle",[["Crazy 3x3x3","crz3a",30]]],["Cmetrick",[["Cmetrick","cm3",25],["Cmetrick Mini","cm2",25]]],["Helicopter Cube",[["Heli copter","heli",40],["Curvy copter","helicv",40],["2x2 Heli random move","heli2x2",70],["2x2 Heli by group","heli2x2g",5]]],["Redi Cube",[["random state","rediso",0],["MoYu","redim",8],["random move","redi",20]]],["Ivy cube",[["random state","ivyso",0],["optimal","ivyo",0],["random move","ivy",10]]],["Master Pyraminx",[["random state","mpyrso",0],["random move","mpyr",42]]],["Pyraminx Crystal",[["Pochmann","prcp",70],["old style","prco",70]]],["Siamese Cube",[["1x1x3 block","sia113",25],["1x2x3 block","sia123",25],["2x2x2 block","sia222",25]]],["Square",[["Square-2","sq2",20],["Super Square-1","ssq1t",20]]],["Super Floppy",[[" ","sfl",25]]],["UFO",[["Jaap style","ufo",25]]],["FTO",[["random state","ftoso",0],["random move","fto",30],["L3T","ftol3t",0],["L3T+LBT","ftol4t",0]]],["Icosahedron",[["Icosamate random move","ctico",60]]],["===SPECIAL===",[["--","blank",0]]],["3x3x3 subsets",[["2-generator R,U","2gen",0],["2-generator L,U","2genl",0],["Roux-generator M,U","roux",25],["3-generator F,R,U","3gen_F",0],["3-generator R,U,L","3gen_L",0],["3-generator R,r,U","RrU",25],["Domino Subgroup","333drud",0],["half turns only","half",0],["last slot + last layer (old)","lsll",15]]],["Bandaged Cube",[["Bicube","bic",30],["Square-1 /,(1,0)","bsq",25]]],["Relays",[["lots of 3x3x3s","r3",5],["234 relay","r234",0],["2345 relay","r2345",0],["23456 relay","r23456",0],["234567 relay","r234567",0],["234 relay (WCA)","r234w",0],["2345 relay (WCA)","r2345w",0],["23456 relay (WCA)","r23456w",0],["234567 relay (WCA)","r234567w",0],["Mini Guildford","rmngf",0]]],["===JOKES===",[["--","blank",0]]],["1x1x1",[["x y z","111",25]]],["-1x-1x-1",[[" ","-1",25]]],["1x1x2",[[" ","112",25]]],["LOL",[[" ","lol",25]]],["Derrick Eide",[[" ","eide",25]]]];function it(e){for(const[,n]of Ue)for(const[,o,l]of n)if(o===e)return[o,l||0];return null}let $="";async function V(e="333",n){const o=it(e);if(!o)return;const[l,s]=o;let r;r=await Ne.getScramble(l,s);const i=await Ne.getImage(r,l);$=r,n.innerHTML=i,dt(e,n);const m=document.getElementById("scrambleDisplay");l==="mgmp"?m.textContent=at(r):m.textContent=r,ct(n)}function at(e){const n=e.split(" ");let o=[],l=[];for(const s of n)l.push(s),(s==="U"||s==="U'")&&(o.push(l.join(" ")),l=[]);return l.length&&o.push(l.join(" ")),o.join(`
`)}function ct(e){const n=document.getElementById("scrambleContainer"),o=document.getElementById("scrambleDisplay");let l=40;for(e.id==="scrambleVis2"&&(l=25),o.style.fontSize=l+"px",o.style.whiteSpace="pre-wrap",o.style.wordBreak="break-word",o.offsetHeight;o.scrollHeight>n.clientHeight+50;)l-=1,o.style.fontSize=l+"px"}function dt(e,n){console.log(e),["333","333ni","r3ni","333oh","333fm"].includes(e)?A(.45,75,70,n):e==="222so"?A(.6,-43,-10,n):e==="pyrso"?A(.4,55,70,n):["444wca","444bld"].includes(e)?A(.35,130,110,n):e==="skbso"?A(.4,65,75,n):["555wca","555bld"].includes(e)?A(.3,165,135,n):e==="666wca"?A(.25,180,150,n):e==="777wca"?A(.22,195,155,n):e==="mgmp"?A(.5,105,40,n):e==="clkwca"?A(.5,60,15,n):e==="sqrs"&&A(.4,105,55,n)}function A(e,n,o,l){let s=null;if(l.id==="scrambleVis"){s=document.querySelector(".panel-cube"),s.style.transformOrigin="bottom right",s.style.transform=`scale(${e})`,s.style.position="absolute",s.style.right=`${n}px`,s.style.bottom=`${o}px`;const r=document.getElementById("scrambleVis"),i=r.width||600,m=r.height||400;s.style.width=i*e+"px",s.style.height=m*e+"px"}else{o+=50,s=document.querySelector(".panel-cube2"),s.style.transformOrigin="bottom center",s.style.transform=`scale(${e})`,s.style.right=`${n}px`,s.style.bottom=`${o}px`;const r=document.getElementById("scrambleVis"),i=r.width||600,m=r.height||400;s.style.width=i*e+"px",s.style.height=m*e+"px"}}const d={mode:"ao5",solveCounter:0,solvesArray:[]},Te=JSON.parse(localStorage.getItem("cube_average_buffer"));Te&&Object.assign(d,Te);function Se(e){if(typeof e=="number")return e;if(e.includes(":")){const[n,o]=e.split(":");return parseInt(n,10)*60+parseFloat(o)}return parseFloat(e)}function mt(e){const n=Number(e);return Number.isFinite(n)?d.mode==="fmc3"?`${Number.isInteger(e)?e:e.toFixed(2)} moves`:n.toFixed(2):"-"}function Ze(e){if(e>=60){const n=Math.floor(e/60),o=(e%60).toFixed(2).padStart(5,"0");return`${n}:${o}`}return e.toFixed(2)}function se(e){return e.time==null?"-":d.mode==="fmc3"?e.penalty==="DNF"?"DNF":e.penalty==="+2"?`${e.time+2} moves (+2)`:`${e.time} moves`:e.penalty==="DNF"?"DNF":e.penalty==="+2"?Ze(e.time+2)+" (+2)":Ze(e.time)}function p(e){if(e==="DNF"||(e=Number(e),!Number.isFinite(e)))return"DNF";if(e>=60){const n=Math.floor(e/60),o=(e%60).toFixed(2).padStart(5,"0");return`${n}:${o}`}return mt(e)}function K(e,n){const o=e.map(c=>c.penalty==="DNF"?1/0:c.penalty==="+2"?c.time+2:c.time);let l=null,s=null;if(n==="bo3"){if(o.filter(E=>E===1/0).length>=2)return{dnf:!0};const a=[...o].sort((E,h)=>E-h);l=a[0],s=a[a.length-1];const u=o.filter(E=>E!==1/0),S=u.reduce((E,h)=>E+h,0)/u.length,F=u.reduce((E,h)=>E+Math.pow(h-S,2),0)/u.length,H=Math.sqrt(F);return{dnf:!1,avg:S,best:l,worst:s,sigma:H}}if(n==="bo5"){const c=[...o].sort((h,B)=>h-B);l=c[0],s=c[c.length-1];const a=c.slice(1,4);let u=null;a.includes(1/0)?u="DNF":u=a.reduce((h,B)=>h+B,0)/a.length;const S=o.filter(h=>h!==1/0),F=S.reduce((h,B)=>h+B,0)/S.length,H=S.reduce((h,B)=>h+Math.pow(B-F,2),0)/S.length,E=Math.sqrt(H);return{dnf:!1,avg:u,best:l,worst:s,sigma:E}}if(n==="ao5"){if(o.filter(B=>B===1/0).length>=2)return{dnf:!0};const a=[...o].sort((B,I)=>B-I);l=a[0],s=a[a.length-1];const u=a.slice(1,4);let S=null;u.includes(1/0)?S="DNF":S=u.reduce((B,I)=>B+I,0)/u.length;const F=o.filter(B=>B!==1/0),H=F.reduce((B,I)=>B+I,0)/F.length,E=F.reduce((B,I)=>B+Math.pow(I-H,2),0)/F.length,h=Math.sqrt(E);if(a.length===4){const B=(a[0]+a[1]+a[2])/3,I=(a[3]+a[2]+a[1])/3;return{dnf:!1,avg:S,best:l,worst:s,sigma:h,bpAo5:B,wpA05:I}}return{dnf:!1,avg:S,best:l,worst:s,sigma:h}}if(n==="fmc3"){const c=e.map(I=>I.penalty==="DNF"?1/0:I.penalty==="+2"?I.time+2:I.time);if(c.filter(I=>I===1/0).length>=2)return{dnf:!0};const u=c.filter(I=>I!==1/0),S=u.reduce((I,te)=>I+te,0)/u.length,F=Math.min(...u),H=Math.max(...u),E=u.reduce((I,te)=>I+te,0)/u.length,h=u.reduce((I,te)=>I+Math.pow(te-E,2),0)/u.length,B=Math.sqrt(h);return{dnf:!1,avg:S,best:F,worst:H,sigma:B}}if(o.filter(c=>c===1/0).length>=1)return{dnf:!0};const i=o.reduce((c,a)=>c+a,0)/o.length,m=o.reduce((c,a)=>c+Math.pow(a-i,2),0)/o.length,g=Math.sqrt(m);return l=Math.min(...o),s=Math.max(...o),{dnf:!1,avg:i,best:l,worst:s,sigma:g}}function ge(e,n,o,l,s=!1){let r=null;(l==="WCA"||d.mode==="fmc3")&&(o>=15&&(r="+2"),o>=17&&(r="DNF"));let i=null;s?i=e.moveCount:i=Se(e);const m=e.solution?e.solution:null;d.solvesArray.push({time:i,penalty:r||null,scramble:n,inspection:o,createdAt:Date.now(),solution:m}),console.log(d.solvesArray[0]),d.solveCounter++;let g=3;if((d.mode==="ao5"||d.mode==="bo5")&&(g=5),d.solveCounter===g){const c=K(d.solvesArray,d.mode),a={mode:d.mode,average:c.avg==="DNF"?"DNF":p(c.avg),worst:p(c.worst),best:p(c.best),sigma:p(c.sigma),solves:structuredClone(d.solvesArray)};return d.solvesArray=[],d.solveCounter=0,localStorage.setItem("cube_average_buffer",JSON.stringify(d)),a}return localStorage.setItem("cube_average_buffer",JSON.stringify(d)),null}const v={sessions:JSON.parse(localStorage.getItem("sessions"))||{Default:{averages:[]}},currentSession:localStorage.getItem("currentSession")||"Default",selectEl:document.getElementById("sessionSelect")},ut=C();d.mode=ut.mode||"ao5";const We=document.getElementById("modeSelect");We&&(We.value=d.mode);function D(){localStorage.setItem("sessions",JSON.stringify(v.sessions)),localStorage.setItem("currentSession",v.currentSession)}function C(){return v.sessions[v.currentSession]||(v.sessions[v.currentSession]={averages:[]}),v.sessions[v.currentSession]}function j(){const e=v.selectEl;e.innerHTML="",Object.keys(v.sessions).forEach(o=>{const l=document.createElement("option");l.value=o,l.textContent=o,o===v.currentSession&&(l.selected=!0),e.appendChild(l)});const n=document.createElement("option");n.disabled=!0,n.textContent="â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€",e.appendChild(n),e.appendChild(new Option("âž• New session...","__new__")),e.appendChild(new Option("âœ Rename current...","__rename__")),e.appendChild(new Option("ðŸ—‘ Delete current...","__delete__"))}function ae(e){v.currentSession=e,D(),j(),document.dispatchEvent(new CustomEvent("sessionChanged"))}v.selectEl.onchange=()=>{const e=v.selectEl.value;if(e==="__new__"){const n=prompt("New session name:");if(!n||v.sessions[n]){j();return}v.sessions[n]={averages:[]},ae(n);return}if(e==="__rename__"){const n=v.currentSession,o=prompt("Rename session:",n);if(!o||o===n||v.sessions[o]){j();return}v.sessions[o]=v.sessions[n],delete v.sessions[n],ae(o);return}if(e==="__delete__"){if(Object.keys(v.sessions).length===1){alert("You must have at least one session."),j();return}if(!confirm("Delete current session?")){j();return}delete v.sessions[v.currentSession];const n=Object.keys(v.sessions)[0];ae(n);return}ae(e)};j();function yt(){if(!confirm("Delete all averages in this session?"))return;const e=C();e.averages=[],D(),d.solvesArray=[],d.scramblesArray=[],d.solveCounter=0,localStorage.setItem("cube_average_buffer",JSON.stringify(d))}function gt(){const e=C();d.mode=e.mode||"ao5";const n=document.getElementById("modeSelect");n&&(n.value=d.mode),d.solvesArray=[],d.scramblesArray=[],d.solveCounter=0}function Le(){const e=re();let n='<h3 class="modal-title">Session averages</h3>';e.forEach((o,l)=>{let s=`${o.mode} #${e.length-l}: ${o.average}`;if(o.mode==="bo3"){const r=K(o.solves,"mo3"),i=r.avg==="DNF"?"DNF":p(r.avg);s=`${o.mode} #${e.length-l}: ${o.average} (mo3: ${i})`}else if(o.mode==="bo5"){const r=K(o.solves,"ao5"),i=r.avg==="DNF"?"DNF":p(r.avg);s=`${o.mode} #${e.length-l}: ${o.average} (ao5: ${i})`}n+=`
            <div class="modal-average-card">
                <div class="modal-average-header">
                    <b>${s}</b>
                </div>

                <div class="modal-solves">
        `,o.solves.forEach((r,i)=>{n+=`
                <div class="modal-solve-row">
                    <div class="modal-solve-main">
                        <span>#${i+1}: ${se(r)}</span>

                        <div class="modal-solve-actions">
                            <button onclick="setPenalty(${l}, ${i}, null)">OK</button>
                            <button onclick="setPenalty(${l}, ${i}, '+2')">+2</button>
                            <button onclick="setPenalty(${l}, ${i}, 'DNF')">DNF</button>
                            <button onclick="removeSolve(${l}, ${i})">âœ–</button>
                        </div>
                    </div>

                    <div class="modal-scramble">
                        ${o.solves[i].scramble}
                    </div>
                </div>
            `}),n+=`
                </div>
            </div>
        `}),modalBody.innerHTML=n,G.classList.remove("hidden")}function ft(){const e=C();e.averages||(e.averages=[])}function fe(e){ft(),C().averages.unshift(e),D()}function re(){return C().averages||[]}function pt(){if(d.solvesArray.length>0)return{type:"current",solveIndex:d.solvesArray.length-1};const e=re();if(e.length===0)return null;const n=0,o=e[0];return!o||o.solves.length===0?null:{type:"saved",blockIndex:n,solveIndex:o.solves.length-1}}window.setPenalty=function(e,n,o){vt(e,n,o),D(),w(),G.classList.contains("hidden")||Le()};window.removeSolve=function(e,n){bt(e,n),D(),w(),localStorage.setItem("cube_average_buffer",JSON.stringify(d)),G.classList.contains("hidden")||Le()};function vt(e,n,o){const s=re()[e];s.solves[n].penalty=o;const r=K(s.solves,s.mode).avg;s.average=r==="DNF"?"DNF":p(r),D()}function bt(e,n){const o=re();if(e===-1){if(n<0||n>=d.solvesArray.length)return;d.solvesArray.splice(n,1),d.solveCounter--,d.solveCounter<0&&(d.solveCounter=0);return}const l=o[e];if(e===0&&d.solvesArray.length===0){const r=l.solves.filter((i,m)=>m!==n);d.solvesArray=structuredClone(r),d.solveCounter=r.length,o.splice(e,1),G.classList.add("hidden"),D();return}if(confirm(`This solve belongs to a finished average.

OK = Replace this solve (reopen average)
Cancel = Delete the whole average`)){const r=l.solves.filter((i,m)=>m!==n);d.solvesArray=structuredClone(r),d.solveCounter=r.length,o.splice(e,1),G.classList.add("hidden"),D();return}confirm("Delete the entire average? This cannot be undone.")&&(o.splice(e,1),D())}function De(e){const n=pt();n&&(n.type==="current"?d.solvesArray[n.solveIndex].penalty=e:window.setPenalty(n.blockIndex,n.solveIndex,e))}const It=-180,de=It*60*1e3;function Bt(e=Date.now()){const n=new Date(e+de);return n.setUTCHours(0,0,0,0),n.getTime()-de}function ht(e=Date.now()){const n=new Date(e+de);return n.setUTCHours(23,59,59,999),n.getTime()-de}function Me(e){const n=[];return e.averages.forEach(o=>{o.solves.forEach(l=>{n.push(l)})}),d.solvesArray.forEach(o=>n.push(o)),n}function Ve(e,n){let o=[],l=[],s=0;if(n.averages.forEach(a=>{a.average!=="DNF"&&l.push(Se(a.average))}),e.forEach(a=>{a.penalty===null?(o.push(a.time),s++):(a.penalty==="+2"&&o.push(a.time+2),s++)}),o.length===0)return{bestTime:0,mean:0,sigma:0,bestAvg:0,solveCounter:s};const r=l.length?Math.min(...l):0,i=Math.min(...o),m=o.reduce((a,u)=>a+u,0)/o.length,g=o.reduce((a,u)=>a+Math.pow(u-m,2),0)/o.length,c=Math.sqrt(g);return{bestTime:i,mean:m,sigma:c,bestAvg:r,solveCounter:s}}function Ct(e,n){const o=Date.now();let l,s;return l=Bt(o),s=ht(o),e.filter(r=>r.createdAt>=l&&r.createdAt<=s)}function He(){const e=C(),n=Me(e);return Ve(n,e)}function Et(e){const n=C(),o=Me(n),l=Ct(o);return Ve(l,n)}function St(){const e=He();document.getElementById("stat-solves").textContent=e.solveCounter,document.getElementById("stat-best-time").textContent=p(e.bestTime),document.getElementById("stat-mean").textContent=p(e.mean),document.getElementById("stat-sigma").textContent=p(e.sigma),document.getElementById("stat-best-avg").textContent=p(e.bestAvg);const n=C(),o=document.getElementById("avg-table-head"),l=document.getElementById("avg-history-body");o.innerHTML="",l.innerHTML="";let s=0;n.averages.forEach(i=>{i.solves.length>s&&(s=i.solves.length)});let r=`<tr>
  <th>#</th>
  <th>Type</th>
  <th>Avg</th>
  <th>Best</th>
  <th>Worst</th>

`;for(let i=0;i<s;i++)r+=`<th>${i+1}</th>`;r+="  <th>Ïƒ</th></tr>",o.innerHTML=r,n.averages.forEach((i,m)=>{const g=document.createElement("tr");i.mode==="bo3"||i.mode;let c=`
      <td>${n.averages.length-m}</td>
      <td>${i.mode.toUpperCase()}</td>
      <td>${i.average}</td>
      <td><strong>${i.best}</strong></td>
      <td>${i.worst}</td>

    `;i.solves.forEach(a=>{c+=`<td>${se(a)}</td>`}),c+=`<td>${i.sigma}</td>`,g.innerHTML=c,l.appendChild(g)})}const y={timerPhase:0,interval:0,wcaInterval:0,wcaDelayCount:!1,inspecting:!1,inspection:0},f={inspectionType:localStorage.getItem("inspectionType")||"WCA",timerFlag:!1,previousInspectionType:f.inspectionType};document.getElementById("inspection-type").value=f.inspectionType;document.getElementById("inspection-type").addEventListener("change",()=>{previousInspectionType=f.inspectionType,f.inspectionType=document.getElementById("inspection-type").value,localStorage.setItem("inspectionType",f.inspectionType)});let le=localStorage.getItem("delayFlagType")||"WCA";document.getElementById("delay-flag").value=le;document.getElementById("delay-flag").addEventListener("change",()=>{le=document.getElementById("delay-flag").value,localStorage.setItem("delayFlagType",le)});let M=localStorage.getItem("timeInsertion")||"Timer";M==="Typing"?f.timerFlag=!0:f.timerFlag=!1;document.getElementById("time-insertion").value=M;document.getElementById("time-insertion").addEventListener("change",()=>{M=document.getElementById("time-insertion").value,M==="Typing"?f.timerFlag=!0:f.timerFlag=!1,localStorage.setItem("timeInsertion",M),Oe()});function Oe(){const e=document.getElementById("typing-container");if(e)if(M==="Typing"){e.style.display="block";const n=document.getElementById("typed-time");n&&n.focus()}else e.style.display="none"}let U=null;document.addEventListener("DOMContentLoaded",()=>{Oe();const e=document.getElementById("typed-time-add"),n=document.getElementById("typed-time");e&&n&&(e.addEventListener("click",()=>{const o=n.value.trim().replace(",",".");if(!o)return;const l=Se(o);if(!Number.isFinite(l)){n.style.border="2px solid #e74c3c",n.focus(),setTimeout(()=>n.style.border="",1500);return}U=p(l),document.getElementById("timer").textContent=U;const s=ge(l,$,y.inspection,f.inspectionType);s&&fe(s),w(),V(b.event,x),n.value=""}),n.addEventListener("keydown",o=>{o.key==="Enter"&&(o.preventDefault(),e.click())}))});function Lt(e,n){let o="";return e==="live"&&(o+=`
            <div class="history-average current-average">
                <div class="history-solves">
        `,d.solvesArray.forEach((l,s)=>{o+=`
                <div class="history-solve">
                    ${s+1} - ${se(l)}
                </div>
            `}),o+=`
                </div>
            </div>
        `),e==="saved"&&n&&(o+=`
            <div class="history-average current-average">
                <div class="history-solves">
        `,n.solves.forEach((l,s)=>{o+=`
                <div class="history-solve">
                    ${s+1} - ${se(l)}
                </div>
            `}),o+=`
                </div>
            </div>
        `),o}function Dt(e,n){U&&f.timerFlag&&(document.getElementById("timer").textContent=U);let o="";for(let l=0;l<e.length;l++){const s=e[l];if(n==="saved"&&l===0)continue;let r=`${s.mode==="fmc3"?"ao3":s.mode}: ${s.average}`;if(s.mode==="bo3"){const i=K(s.solves,"mo3"),m=i.avg==="DNF"?"DNF":p(i.avg);r=`${s.mode}: ${s.average} (mo3: ${m})`}else if(s.mode==="bo5"){const i=K(s.solves,"ao5"),m=i.avg==="DNF"?"DNF":p(i.avg);r=`${s.mode}: ${s.average} (ao5: ${m})`}o+=`
            <div class="history-block history-average">
                <div class="history-solves">
        `,s.solves.forEach((i,m)=>{o+=`
                <div class="history-solve">
                    ${m+1} - ${se(i)}
                </div>
            `}),o+=`
                </div>
                <div class="history-title">
                    ${r}
                </div>
            </div>
        `}return o}function Re(e){return`
        Best single: ${e.bestTime!==1/0?p(e.bestTime):"-"}
        <br>
        Best ao5: ${e.bestAvg!==1/0?p(e.bestAvg):"-"}
        <br>
        Session Mean: ${e.mean?p(e.mean):"-"}
        <br>
        Session &sigma;: ${e.sigma?p(e.sigma):"-"}
        <br>
        Solves: ${e.solveCounter?e.solveCounter:"-"}
    `}function xt({type:e,solves:n,mode:o,block:l}){if(e==="live"){if(!n||n.length===0)return"";const s=K(n,o),r=s.best,i=s.worst,m=s.sigma,g=s.bpAo5,c=s.wpA05;return n.length===4&&o==="ao5"?`                
                Best: ${p(r)}
                <br>
                Worst: ${p(i)}
                <br>
                &sigma;: ${p(m)}
                <hr>
                bpAo5: ${p(g)}
                <br>
                wpAo5: ${p(c)}
            `:`                
            Best: ${p(r)}
            <br>
            Worst: ${p(i)}
            <br>
            &sigma;: ${p(m)}
        `}return e==="saved"&&l?`                
            Best: ${l.best}
            <br>
            Worst: ${l.worst}
            <br>
            &sigma;: ${l.sigma}
            <hr>
            ${l.mode==="fmc3"?"ao3":l.mode}: ${l.average}
        `:""}function w(){const e=re(),n=He(),o=Et(),l=document.getElementById("currentAverageValue"),s=document.getElementById("historyPanel"),r=document.getElementById("current-stats"),i=document.getElementById("stats"),m=document.getElementById("today-stats");let g=null,c=null;d.solvesArray.length>0?g="live":e.length>0&&(g="saved",c=e[0]),l&&(l.innerHTML=Lt(g,c)),r&&(r.innerHTML=xt({type:g,solves:d.solvesArray,mode:d.mode,block:c})),s&&(s.innerHTML=Dt(e,g)),i&&(i.innerHTML=Re(n),m.innerHTML=Re(o))}const t={U:Array(9).fill("W"),R:Array(9).fill("R"),F:Array(9).fill("G"),D:Array(9).fill("Y"),L:Array(9).fill("O"),B:Array(9).fill("B")};function X(e){[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]=[e[6],e[3],e[0],e[7],e[4],e[1],e[8],e[5],e[2]]}function be(){const e=t.U[1],n=t.U[4],o=t.U[7],l=t.F[1],s=t.F[4],r=t.F[7],i=t.D[1],m=t.D[4],g=t.D[7],c=t.B[7],a=t.B[4],u=t.B[1];t.F[1]=e,t.F[4]=n,t.F[7]=o,t.D[1]=l,t.D[4]=s,t.D[7]=r,t.B[7]=i,t.B[4]=m,t.B[1]=g,t.U[1]=c,t.U[4]=a,t.U[7]=u}function Ie(){const e=t.F[3],n=t.F[4],o=t.F[5],l=t.R[3],s=t.R[4],r=t.R[5],i=t.B[3],m=t.B[4],g=t.B[5],c=t.L[3],a=t.L[4],u=t.L[5];t.R[3]=e,t.R[4]=n,t.R[5]=o,t.B[3]=l,t.B[4]=s,t.B[5]=r,t.L[3]=i,t.L[4]=m,t.L[5]=g,t.F[3]=c,t.F[4]=a,t.F[5]=u}function wt(){const e=t.U[3],n=t.U[4],o=t.U[5],l=t.R[1],s=t.R[4],r=t.R[7],i=t.D[5],m=t.D[4],g=t.D[3],c=t.L[7],a=t.L[4],u=t.L[1];t.R[1]=e,t.R[4]=n,t.R[7]=o,t.D[5]=l,t.D[4]=s,t.D[3]=r,t.L[7]=i,t.L[4]=m,t.L[1]=g,t.U[3]=c,t.U[4]=a,t.U[5]=u}function Q(){q(),be(),be(),be(),W(),W(),W()}function z(){O(),Ie(),Ie(),Ie(),Z(),Z(),Z()}function P(){Y(),wt(),R(),R(),R()}function At(){t.U.fill("W"),t.R.fill("R"),t.F.fill("G"),t.D.fill("Y"),t.L.fill("O"),t.B.fill("B")}function Ft(){return{U:[...t.U],R:[...t.R],F:[...t.F],D:[...t.D],L:[...t.L],B:[...t.B]}}function Nt(e){t.U=[...e.U],t.R=[...e.R],t.F=[...e.F],t.D=[...e.D],t.L=[...e.L],t.B=[...e.B]}function O(){X(t.U);const e=t.F[0],n=t.F[1],o=t.F[2],l=t.R[0],s=t.R[1],r=t.R[2],i=t.B[0],m=t.B[1],g=t.B[2],c=t.L[0],a=t.L[1],u=t.L[2];t.F[0]=l,t.F[1]=s,t.F[2]=r,t.R[0]=i,t.R[1]=m,t.R[2]=g,t.B[0]=c,t.B[1]=a,t.B[2]=u,t.L[0]=e,t.L[1]=n,t.L[2]=o}function Z(){X(t.D);const e=t.F[6],n=t.F[7],o=t.F[8],l=t.R[6],s=t.R[7],r=t.R[8],i=t.B[6],m=t.B[7],g=t.B[8],c=t.L[6],a=t.L[7],u=t.L[8];t.R[6]=e,t.R[7]=n,t.R[8]=o,t.B[6]=l,t.B[7]=s,t.B[8]=r,t.L[6]=i,t.L[7]=m,t.L[8]=g,t.F[6]=c,t.F[7]=a,t.F[8]=u}function q(){X(t.R);const e=t.U[2],n=t.U[5],o=t.U[8],l=t.F[2],s=t.F[5],r=t.F[8],i=t.D[2],m=t.D[5],g=t.D[8],c=t.B[6],a=t.B[3],u=t.B[0];t.B[6]=e,t.B[3]=n,t.B[0]=o,t.D[2]=c,t.D[5]=a,t.D[8]=u,t.F[2]=i,t.F[5]=m,t.F[8]=g,t.U[2]=l,t.U[5]=s,t.U[8]=r}function W(){X(t.L);const e=t.U[0],n=t.U[3],o=t.U[6],l=t.F[0],s=t.F[3],r=t.F[6],i=t.D[0],m=t.D[3],g=t.D[6],c=t.B[8],a=t.B[5],u=t.B[2];t.F[0]=e,t.F[3]=n,t.F[6]=o,t.D[0]=l,t.D[3]=s,t.D[6]=r,t.B[8]=i,t.B[5]=m,t.B[2]=g,t.U[0]=c,t.U[3]=a,t.U[6]=u}function Y(){X(t.F);const e=t.U[6],n=t.U[7],o=t.U[8],l=t.R[0],s=t.R[3],r=t.R[6],i=t.D[2],m=t.D[1],g=t.D[0],c=t.L[8],a=t.L[5],u=t.L[2];t.R[0]=e,t.R[3]=n,t.R[6]=o,t.D[2]=l,t.D[1]=s,t.D[0]=r,t.L[8]=i,t.L[5]=m,t.L[2]=g,t.U[6]=c,t.U[7]=a,t.U[8]=u}function R(){X(t.B);const e=t.U[0],n=t.U[1],o=t.U[2],l=t.R[2],s=t.R[5],r=t.R[8],i=t.D[8],m=t.D[7],g=t.D[6],c=t.L[0],a=t.L[3],u=t.L[6];t.U[0]=l,t.U[1]=s,t.U[2]=r,t.R[2]=i,t.R[5]=m,t.R[8]=g,t.D[6]=c,t.D[7]=a,t.D[8]=u,t.L[0]=o,t.L[3]=n,t.L[6]=e}function Tt(){for(const e in t){const n=t[e][0];for(let o=1;o<9;o++)if(t[e][o]!==n)return!1}return!0}let Ce=0;function Zt(){return Ce}function qe(e,n=!0){const l=e.split(" "),s={U:O,"U'":()=>{O(),O(),O()},U2:()=>{O(),O()},D:Z,"D'":()=>{Z(),Z(),Z()},D2:()=>{Z(),Z()},R:q,"R'":()=>{q(),q(),q()},R2:()=>{q(),q()},L:W,"L'":()=>{W(),W(),W()},L2:()=>{W(),W()},F:Y,"F'":()=>{Y(),Y(),Y()},F2:()=>{Y(),Y()},B:R,"B'":()=>{R(),R(),R()},B2:()=>{R(),R()},y:z,"y'":()=>{z(),z(),z()},y2:()=>{z(),z()},x:Q,"x'":()=>{Q(),Q(),Q()},x2:()=>{Q(),Q()},z:P,"z'":()=>{P(),P(),P()},z2:()=>{P(),P()}};n&&At(),Ce=0,l.forEach(r=>{const i=s[r];i&&(i(),["y","y'","y2","x","x'","x2","z","z'","z2"].includes(r)||Ce++)})}function Wt(){if(document.getElementById("cubisz-css"))return;const e=document.createElement("link");e.id="cubisz-css",e.rel="stylesheet",e.href=new URL("data:text/css;base64,LnBhZ2UtY2VudGVyLCAjY3ViZS13cmFwcGVyIHsNCiAgcG9zaXRpb246IHJlbGF0aXZlOyAgICAgICAgICAvKiByZW1vdmUgZnJvbSBkb2N1bWVudCBmbG93ICovDQogIGluc2V0OiAwOyAgICAgICAgICAgICAgICAgLyogZnVsbCB2aWV3cG9ydCAqLw0KICBkaXNwbGF5OiBncmlkOw0KICBwbGFjZS1pdGVtczogY2VudGVyOyAgICAgIC8qIHRydWUgY2VudGVyICovDQogIHBvaW50ZXItZXZlbnRzOiBub25lOyAgICAgLyogYWxsb3cgY2xpY2tzIG91dHNpZGUgY3ViZSAqLw0KfQ0KDQouZ3JpZC1jb250YWluZXIgew0KICBwb2ludGVyLWV2ZW50czogYXV0bzsgICAgIC8qIGN1YmUgaXMgY2xpY2thYmxlICovDQogIGRpc3BsYXk6IGdyaWQ7DQogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KDQsIG1heC1jb250ZW50KTsNCiAgZ3JpZC10ZW1wbGF0ZS1yb3dzOiByZXBlYXQoMywgbWF4LWNvbnRlbnQpOw0KICB3aWR0aDogZml0LWNvbnRlbnQ7DQogIGhlaWdodDogZml0LWNvbnRlbnQ7DQp9DQoNCg0KICAuZ3JpZCB7DQogICAgZGlzcGxheTogZ3JpZDsNCiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdCgzLCA2MHB4KTsgLyogMyBjb2x1bW5zIG9mIDYwcHggZWFjaCAqLw0KICAgIGdhcDogNXB4OyAvKiBnYXAgYmV0d2VlbiB0aGUgc3F1YXJlcyAqLw0KICAgIGJvcmRlcjogMnB4IHNvbGlkIGJsYWNrOyAvKiBBZGQgYSBibGFjayBib3JkZXIgKi8NCiAgICBtYXJnaW46IC0ycHg7DQogICAgcGFkZGluZzogNXB4OyAvKiBPcHRpb25hbCBwYWRkaW5nIGluc2lkZSB0aGUgYm9yZGVyICovDQogICAgYmFja2dyb3VuZC1jb2xvcjogYmxhY2s7DQogIH0NCg0KICAuc3F1YXJlIHsNCiAgICB3aWR0aDogNThweDsgLyogd2lkdGggb2YgZWFjaCBzcXVhcmUgKi8NCiAgICBoZWlnaHQ6IDYwcHg7IC8qIGhlaWdodCBvZiBlYWNoIHNxdWFyZSAqLw0KICB9DQoNCiAgLndoaXRlLXNxdWFyZSB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7DQogIH0NCg0KICAub3JhbmdlLXNxdWFyZSB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogb3JhbmdlOw0KICB9DQoNCiAgLmdyZWVuLXNxdWFyZSB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogZ3JlZW47DQogIH0NCg0KICAucmVkLXNxdWFyZSB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogcmVkOw0KICB9DQoNCiAgLmJsdWUtc3F1YXJlIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBibHVlOw0KICB9DQoNCiAgLnllbGxvdy1zcXVhcmUgew0KICAgIGJhY2tncm91bmQtY29sb3I6IHllbGxvdzsNCiAgfQ0KIA0KDQoNCiN3aGl0ZVNxdWFyZUdyaWQgIHsgZ3JpZC1jb2x1bW46IDI7IGdyaWQtcm93OiAxOyB9DQojb3JhbmdlU3F1YXJlR3JpZCB7IGdyaWQtY29sdW1uOiAxOyBncmlkLXJvdzogMjsgfQ0KI2dyZWVuU3F1YXJlR3JpZCAgeyBncmlkLWNvbHVtbjogMjsgZ3JpZC1yb3c6IDI7IH0NCiNyZWRTcXVhcmVHcmlkICAgIHsgZ3JpZC1jb2x1bW46IDM7IGdyaWQtcm93OiAyOyB9DQojYmx1ZVNxdWFyZUdyaWQgICB7IGdyaWQtY29sdW1uOiA0OyBncmlkLXJvdzogMjsgfQ0KI3llbGxvd1NxdWFyZUdyaWQgeyBncmlkLWNvbHVtbjogMjsgZ3JpZC1yb3c6IDM7IH0NCg0KI2N1c3RvbS1zY3JhbWJsZSwgI2N1c3RvbS1zb2x2ZSB7DQogIHdpZHRoOiAzMCU7DQp9DQoNCi8qID09PT09PT09PT09PT09PT09PT09PT09PT0gKi8NCi8qIDNEIE1PREUgKGRvZXMgTk9UIGFmZmVjdCAyRCkgKi8NCi8qID09PT09PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KLnBhZ2UtY2VudGVyew0KICBwZXJzcGVjdGl2ZTogMTAwMHB4OyAvKiBuZWVkZWQgZm9yIDNEICovDQp9DQoNCi8qIHdoZW4gM0QgaXMgYWN0aXZlLCBraWxsIHRoZSBncmlkIGxheW91dCAqLw0KLmN1YmUzZCAuZ3JpZC1jb250YWluZXJ7DQogIGRpc3BsYXk6IGJsb2NrOw0KICBwb3NpdGlvbjogcmVsYXRpdmU7DQogIHRyYW5zZm9ybS1zdHlsZTogcHJlc2VydmUtM2Q7DQogIHdpZHRoOiAyMDBweDsNCiAgaGVpZ2h0OiAyMDBweDsNCg0KICB0cmFuc2Zvcm06IHJvdGF0ZVgoLTI1ZGVnKSByb3RhdGVZKC0zNWRlZyk7DQp9DQoNCg0KLyogYWxsIGZhY2VzIHN0YWNrIGluIHNhbWUgb3JpZ2luICovDQouY3ViZTNkIC5ncmlkew0KICBwb3NpdGlvbjogYWJzb2x1dGU7DQogIHRvcDogNTAlOw0KICBsZWZ0OiA1MCU7DQogIHRyYW5zZm9ybS1vcmlnaW46IGNlbnRlciBjZW50ZXI7DQogIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjZzIGVhc2U7DQogIGJhY2tncm91bmQtY29sb3I6IGJsYWNrOw0KfQ0KDQovKiBSRUFMIGN1YmUgZGVwdGggKGRlcGVuZHMgb24gc3RpY2tlciBzaXplKSAqLw0KOnJvb3R7DQogIC0tY3ViZS1kZXB0aDogNDhweDsNCn0NCg0KLyogRlJPTlQgKGdyZWVuKSAqLw0KLmN1YmUzZCAjZ3JlZW5TcXVhcmVHcmlkew0KICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKSByb3RhdGVZKDBkZWcpIHRyYW5zbGF0ZVoodmFyKC0tY3ViZS1kZXB0aCkpOw0KfQ0KDQovKiBCQUNLIChibHVlKSAqLw0KLmN1YmUzZCAjYmx1ZVNxdWFyZUdyaWR7DQogIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpIHJvdGF0ZVkoMTgwZGVnKSB0cmFuc2xhdGVaKHZhcigtLWN1YmUtZGVwdGgpKTsNCn0NCg0KLyogUklHSFQgKHJlZCkgKi8NCi5jdWJlM2QgI3JlZFNxdWFyZUdyaWR7DQogIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpIHJvdGF0ZVkoOTBkZWcpIHRyYW5zbGF0ZVoodmFyKC0tY3ViZS1kZXB0aCkpOw0KfQ0KDQovKiBMRUZUIChvcmFuZ2UpICovDQouY3ViZTNkICNvcmFuZ2VTcXVhcmVHcmlkew0KICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKSByb3RhdGVZKC05MGRlZykgdHJhbnNsYXRlWih2YXIoLS1jdWJlLWRlcHRoKSk7DQp9DQoNCi8qIFRPUCAod2hpdGUpICovDQouY3ViZTNkICN3aGl0ZVNxdWFyZUdyaWR7DQogIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpIHJvdGF0ZVgoOTBkZWcpIHRyYW5zbGF0ZVoodmFyKC0tY3ViZS1kZXB0aCkpOw0KfQ0KDQovKiBCT1RUT00gKHllbGxvdykgKi8NCi5jdWJlM2QgI3llbGxvd1NxdWFyZUdyaWR7DQogIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpIHJvdGF0ZVgoLTkwZGVnKSB0cmFuc2xhdGVaKHZhcigtLWN1YmUtZGVwdGgpKTsNCn0NCi8qIEZJWCB2ZXJ0aWNhbCBjZW50ZXJpbmcgT05MWSBpbiAzRCBtb2RlICovDQouY3ViZTNkLnBhZ2UtY2VudGVyew0KICBwb3NpdGlvbjogZml4ZWQ7DQogIGluc2V0OiAwOw0KICBkaXNwbGF5OiBmbGV4Ow0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCn0NCg==",import.meta.url).href,document.head.appendChild(e)}let Ye={};function Rt(e){Wt(),e.innerHTML=`
    <div id="cube-net">
      <div class="page-center">
        <div class="grid-container">
          <div id="whiteSquareGrid" class="grid"></div>
          <div id="orangeSquareGrid" class="grid"></div>
          <div id="greenSquareGrid" class="grid"></div>
          <div id="redSquareGrid" class="grid"></div>
          <div id="blueSquareGrid" class="grid"></div>
          <div id="yellowSquareGrid" class="grid"></div>
        </div>
      </div>
    </div>
  `,J("whiteSquareGrid","white-square"),J("orangeSquareGrid","orange-square"),J("greenSquareGrid","green-square"),J("redSquareGrid","red-square"),J("blueSquareGrid","blue-square"),J("yellowSquareGrid","yellow-square"),Ye={U:document.querySelectorAll("#whiteSquareGrid .square"),R:document.querySelectorAll("#redSquareGrid .square"),F:document.querySelectorAll("#greenSquareGrid .square"),D:document.querySelectorAll("#yellowSquareGrid .square"),L:document.querySelectorAll("#orangeSquareGrid .square"),B:document.querySelectorAll("#blueSquareGrid .square")},pe()}function J(e,n){const o=document.getElementById(e);for(let l=0;l<9;l++){const s=document.createElement("div");s.className=`square ${n}`,o.appendChild(s)}}function pe(){const e={W:"white",R:"red",G:"green",Y:"yellow",O:"orange",B:"blue"};for(const n in t){const o=Ye[n];for(let l=0;l<9;l++)o[l].className=`square ${e[t[n][l]]}-square`}}function Gt(e){const n=Math.round(e*.08),o=n;document.querySelectorAll(".grid").forEach(s=>{s.style.gridTemplateColumns=`repeat(3, ${e}px)`,s.style.gap=`${n}px`,s.style.padding=`${o}px`}),document.querySelectorAll(".square").forEach(s=>{s.style.width=`${e}px`,s.style.height=`${e}px`});const l=e*3+n*2+o*2;document.documentElement.style.setProperty("--cube-depth",`${l/2}px`)}function kt(e){document.getElementById("cube-net").classList.toggle("cube3d",e)}let $e=null;function Ut(e){Rt(e),pe()}function Mt(e){Gt(e)}function Vt(e){kt(e==="3d")}function Ke(e){qe(e,!0),pe(),$e=Ft()}function Ht(e){Nt($e),qe(e,!1),pe()}function Qe(){return Zt()}function ze(){return Tt()}const Pe=3600;let me=Pe,ue=null;const Ot=document.getElementById("timer"),qt=document.getElementById("countdown"),Yt=document.getElementById("submit-moves");function $t(e){const n=String(Math.floor(e/3600)).padStart(2,"0"),o=String(Math.floor(e%3600/60)).padStart(2,"0"),l=String(e%60).padStart(2,"0");return`${n}:${o}:${l}`}function xe(){Ot.textContent=$t(me)}function Kt(){if(ue!==null){Ee();return}ue=setInterval(()=>{document.getElementById("countdown").textContent="Stop attempt",me--,xe(),me<=0&&Ee()},1e3)}function Ee(){document.getElementById("countdown").textContent="Start attempt",me=Pe,xe(),clearInterval(ue),ue=null}qt.addEventListener("click",Kt);Yt.addEventListener("click",Ee);let we=!1;function Ae(){document.getElementById("penaltyOkBtn").style.display="none",document.getElementById("penaltyPlus2Btn").style.display="none",document.getElementById("penaltyDnfBtn").style.display="none",document.getElementById("removeLastBtn").style.display="none",document.getElementById("submit-moves").style.display="block",document.getElementById("fmc-cube").style.display="block",document.getElementById("fmc-solution").style.display="block",document.getElementById("fmc-solution-test").style.display="block",document.getElementById("fmc-move-count").style.display="block",document.getElementById("fmc-form").style.display="flex",document.getElementById("countdown").style.display="block",document.getElementById("typing-container").style.display="none",document.getElementById("timer").style.fontSize="50px",document.getElementById("touchOverlay").style.display="none",xe(),Ut(document.getElementById("fmc-cube")),Mt(28),Vt("3d"),Ke($),we=!1}document.getElementById("fmc-solution").addEventListener("input",e=>{e.preventDefault(),Ht(e.target.value.trim()),we=!0});let ye=null;document.getElementById("fmc-form").addEventListener("submit",e=>{e.preventDefault(),we?(ye=Qe(),document.getElementById("fmc-move-count").innerHTML=`${ye} moves 
      <br>
      Result: ${ze()?"Solved":"DNF"}`):document.getElementById("fmc-move-count").innerHTML="no moves"});document.getElementById("submit-moves").addEventListener("click",async()=>{if(document.getElementById("fmc-solution").value!=="")ye=Qe();else{alert("Submit needs a solution");return}const e={moveCount:ye,solution:document.getElementById("fmc-solution").value};ze()||(y.inspection=17);const n=ge(e,$,y.inspection,f.inspectionType,!0);n&&fe(n),w(),await V(b.event,x),Ke($),document.getElementById("fmc-solution").value=""});const N=document.getElementById("categorySelect"),T=document.getElementById("eventSelect"),Je=Ue.filter(([e])=>!e.startsWith("==="));N.innerHTML="";T.innerHTML="";Je.forEach(([e])=>{const n=document.createElement("option");n.value=e,n.textContent=e,N.appendChild(n)});function Qt(){const e=C();e.category?N.value=e.category:N.selectedIndex=0,N.dispatchEvent(new Event("change")),e.scrambleType&&(T.value=e.scrambleType),T.dispatchEvent(new Event("change"))}N.addEventListener("change",()=>{const e=C();e.category=N.value,D(),T.innerHTML="";const n=Je.find(([l])=>l===N.value);if(!n)return;const[,o]=n;o.forEach(([l,s])=>{if(s==="blank")return;const r=document.createElement("option");r.value=s,r.textContent=l,T.appendChild(r)})});Qt();T.addEventListener("change",async()=>{const e=C();e.event=T.value,b.event=T.value,b.event==="333fm"?(f.timerFlag=!0,document.getElementById("typing-container").style.display="none",document.querySelector(".timerOpt").style.display="none"):(document.querySelector(".timerOpt").style.display="block",M==="Typing"?(document.getElementById("typing-container").style.display="block",y.timerFlag=!0):f.timerFlag=!1),e.scrambleType=b.event,D(),je(b.event),b.event.includes("bf")?(document.getElementById("penaltyOkBtn").style.display="block",document.getElementById("penaltyPlus2Btn").style.display="block",document.getElementById("penaltyDnfBtn").style.display="block",document.getElementById("removeLastBtn").style.display="block",document.getElementById("submit-moves").style.display="none",document.getElementById("fmc-cube").style.display="none",document.getElementById("fmc-solution").style.display="none",document.getElementById("fmc-solution-test").style.display="none",document.getElementById("fmc-move-count").style.display="none",document.getElementById("fmc-form").style.display="none",document.getElementById("countdown").style.display="none",x===document.querySelector("#scrambleVis")?document.getElementById("timer").style.fontSize="140px":document.getElementById("timer").style.fontSize="72px",document.getElementById("timer").textContent="0.00",f.previousInspectionType=f.inspectionType,f.inspectionType="None",document.getElementById("inspection-type").value="None",localStorage.setItem("inspectionType","None")):b.event==="333fm"||(document.getElementById("penaltyOkBtn").style.display="block",document.getElementById("penaltyPlus2Btn").style.display="block",document.getElementById("penaltyDnfBtn").style.display="block",document.getElementById("removeLastBtn").style.display="block",document.getElementById("submit-moves").style.display="none",document.getElementById("fmc-cube").style.display="none",document.getElementById("fmc-solution").style.display="none",document.getElementById("fmc-solution-test").style.display="none",document.getElementById("fmc-move-count").style.display="none",document.getElementById("fmc-form").style.display="none",document.getElementById("countdown").style.display="none",x===document.querySelector("#scrambleVis")?document.getElementById("timer").style.fontSize="140px":document.getElementById("timer").style.fontSize="72px",document.getElementById("timer").textContent="0.00",f.inspectionType=previousInspectionType,document.getElementById("inspection-type").value=previousInspectionType,localStorage.setItem("inspectionType",previousInspectionType)),await V(b.event,x),b.event==="333fm"&&Ae()});const Ge=document.getElementById("modeSelect");Ge&&Ge.addEventListener("change",e=>{const n=e.target.value,o=C();d.mode=n,o.mode=n,D(),w()});function zt(e){return e==="333bf"?"bo5":e==="444bf"||e==="555bf"?"bo3":["666","777"].includes(e)?"mo3":e==="333fm"?"fmc3":"ao5"}function je(e){const n=C(),o=zt(e);if(d.mode!==o){d.mode=o,n.mode=o;const l=document.getElementById("modeSelect");l&&(l.value=o),d.solvesArray=[],d.solveCounter=0,D()}}const G=document.getElementById("detailsModal");document.getElementById("modalBody");const Pt=document.getElementById("closeModalBtn");Pt.onclick=()=>G.classList.add("hidden");G.onclick=e=>{e.target===G&&G.classList.add("hidden")};const Xe=document.getElementById("stats-page"),Jt=document.getElementById("open-stats-btn"),jt=document.getElementById("close-stats-btn");Jt.addEventListener("click",()=>{St(),Xe.classList.add("open")});jt.addEventListener("click",()=>{Xe.classList.remove("open")});document.addEventListener("sessionChanged",async()=>{const e=C();if(e.category&&(N.value=e.category,N.dispatchEvent(new Event("change"))),b.event=e.scrambleType||"333",T.value=e.event||"333",T.dispatchEvent(new Event("change")),b.event==="333fm"){await V(b.event,x),Ae();return}else document.getElementById("penaltyOkBtn").style.display="block",document.getElementById("penaltyPlus2Btn").style.display="block",document.getElementById("penaltyDnfBtn").style.display="block",document.getElementById("removeLastBtn").style.display="block",document.getElementById("submit-moves").style.display="none",document.getElementById("fmc-cube").style.display="none",document.getElementById("fmc-solution").style.display="none",document.getElementById("fmc-solution-test").style.display="none",document.getElementById("fmc-move-count").style.display="none",document.getElementById("fmc-form").style.display="none",document.getElementById("countdown").style.display="none",x===document.querySelector("#scrambleVis")?document.getElementById("timer").style.fontSize="140px":document.getElementById("timer").style.fontSize="72px",document.getElementById("timer").textContent="0.00";await V(b.event,x)});const _={modeSelect:document.getElementById("modeSelect"),clearBtn:document.getElementById("clearBtn"),openSessionBtn:document.getElementById("modal-button"),penaltyOkBtn:document.getElementById("penaltyOkBtn"),penaltyPlus2Btn:document.getElementById("penaltyPlus2Btn"),penaltyDnfBtn:document.getElementById("penaltyDnfBtn"),removeLastBtn:document.getElementById("removeLastBtn")};document.querySelectorAll("button").forEach(e=>{e.addEventListener("click",()=>{e.blur()})});document.querySelectorAll("select").forEach(e=>{e.addEventListener("change",()=>{e.blur()})});document.addEventListener("sessionChanged",()=>{gt(),w()});_.clearBtn.onclick=()=>{yt(),w()};_.openSessionBtn.onclick=Le;_.penaltyOkBtn.onclick=()=>{De(null),w()};_.penaltyPlus2Btn.onclick=()=>{De("+2"),w()};_.penaltyDnfBtn.onclick=()=>{De("DNF"),w()};_.removeLastBtn.onclick=()=>removeLastSolve();w();document.getElementById("scramble-button").addEventListener("click",()=>{if(oe.scrDisplayFlag){document.querySelector(".panel-cube2").style.display="none",document.getElementById("scramble-button").innerHTML="Scramble visualizer",document.getElementById("scramble-button").style.justifySelf="center",oe.scrDisplayFlag=!1;return}oe.scrDisplayFlag=!0,document.querySelector(".panel-cube2").style.display="grid",document.getElementById("scramble-button").style.justifySelf="left",document.getElementById("scramble-button").innerHTML="close"});const b={event:C().scrambleType||"333"};b.event==="333fm"?(f.timerFlag=!0,document.getElementById("typing-container").style.display="none",document.querySelector(".timerOpt").style.display="none"):(document.querySelector(".timerOpt").style.display="block",M==="Typing"?(document.getElementById("typing-container").style.display="block",y.timerFlag=!0):f.timerFlag=!1);const Xt=document.getElementById("eventSelect");let x=null;window.innerWidth>768?x=document.querySelector("#scrambleVis"):x=document.querySelector("#scrambleVis2");const _t=C();b.event=_t.scrambleType||"333";Xt.value=b.event;je(b.event);await V(b.event,x);b.event==="333fm"&&Ae();function _e(e){y.timerPhase!==1?y.timerPhase++:y.timerPhase===1&&(e==="None"?(L("color","limeGreen"),y.timerPhase++):(L("color","red"),y.wcaInterval=setInterval(()=>{L("color","limeGreen"),y.wcaDelayCount++},300)))}function et(){y.wcaDelayCount>=1?(y.timerPhase++,y.wcaDelayCount=0,clearInterval(y.wcaInterval)):(L("color","#eaeaf0"),y.wcaDelayCount=0,clearInterval(y.wcaInterval))}let k=0,ne=null,ce=!1;function Fe(){ce?(ce=!1,clearInterval(ne),ne=null,k=0,U?L("time",U):L("time","0.00")):(ce=!0,L("time",k),ne=setInterval(()=>{k++,L("time",k),k===8&&new Audio("./audio/8seconds.mp3").play(),k===12&&new Audio("./audio/12seconds.mp3").play(),k===17&&(ce=!1,clearInterval(ne),ne=null,k=0,U?L("time",U):L("time","0.00"))},1e3))}function tt(e){y.inspecting=!0;const n=performance.now();let o=-1;y.interval=setInterval(()=>{const l=performance.now()-n,s=Math.floor(l/1e3),r=l/1e3;y.inspection=parseFloat(r.toFixed(2)),e==="WCA"&&s!==o&&(o=s,s===8&&new Audio("./audio/8seconds.mp3").play(),s===12&&new Audio("./audio/12seconds.mp3").play(),s===17&&clearInterval(y.interval)),L("time",s)},10)}function Be(e){return(Math.floor(e*100)/100).toFixed(2)}function en(e){let n=e/1e3,o=Math.floor(n/60),l=Math.floor(o/60);if(o<1)return Be(n);if(o>=1)return n=n-60*o,`${o}: ${n<10?"0":""}${Be(n)}`;if(o>=60)return o=o-60*l,`${l}: ${o<10?"0":""}${o}: ${n<10?"0":""}${Be(n)}`}function nt(e){L("color","#eaeaf0"),clearInterval(y.interval),y.inspecting=!1;const n=performance.now();y.interval=setInterval(()=>{L("time",en(performance.now()-n))},10)}function ot(){clearInterval(y.interval),document.getElementById("timer").innerHTML,y.timerPhase=0}const oe={scrDisplayFlag:!1};function L(e,n){e==="color"?document.getElementById("timer").style.color=n:e==="time"&&(document.getElementById("timer").textContent=n)}function st(){const e=document.getElementById("timer"),n=document.getElementById("touchOverlay");if(!e||!n)return;function o(l){l===e||l===n||(l.contains(e)?[...l.children].forEach(o):l.classList.add("focus-hidden"))}o(document.body)}function lt(){document.querySelectorAll(".focus-hidden").forEach(e=>{e.classList.remove("focus-hidden")})}document.getElementById("touchOverlay").addEventListener("touchstart",e=>{const n=e.target;if(!(n&&n.closest&&(n.closest("input")||n.closest("#typing-container")))&&(e.preventDefault(),!(e.repeat||f.timerFlag))){if(oe.scrDisplayFlag){document.querySelector(".panel-cube2").style.display="none",document.getElementById("scramble-button").style.justifySelf="center",document.getElementById("scramble-button").innerHTML="Scramble visualizer",oe.scrDisplayFlag=!1;return}if(y.timerPhase===0&&f.inspectionType==="None"&&(y.timerPhase=1),_e(le),y.timerPhase===1&&!y.inspecting&&f.inspectionType!=="None"&&tt(f.inspectionType),y.timerPhase===3){ot();const o=ge(document.getElementById("timer").innerHTML,$,y.inspection,f.inspectionType);o&&fe(o),w(),V(b.event,x),lt()}}});document.getElementById("touchOverlay").addEventListener("touchend",e=>{const n=e.target;n&&n.closest&&(n.closest("input")||n.closest("#typing-container"))||(e.preventDefault(),!e.repeat&&(y.timerPhase===1&&et(),y.timerPhase===2&&(nt(),st())))});document.getElementById("touchOverlay").addEventListener("touchstart",()=>{f.timerFlag&&b.event!=="333fm"&&Fe()});document.getElementById("inspection-btn").addEventListener("click",()=>{f.timerFlag&&b.event!=="333fm"&&Fe()});document.addEventListener("keydown",e=>{f.timerFlag&&(e.code!=="Space"||e.repeat||b.event!=="333fm"&&Fe())});function tn(){const e=document.activeElement;return e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable}document.addEventListener("keydown",e=>{if(e.key===" "){if(e.repeat||f.timerFlag||tn())return;e.preventDefault(),y.timerPhase===0&&f.inspectionType==="None"&&(y.timerPhase=1),_e(le)}if(e.key===" "&&y.timerPhase===1&&!y.inspecting&&f.inspectionType!=="None"&&tt(f.inspectionType),e.key===" "&&y.timerPhase===3){ot();const n=ge(document.getElementById("timer").innerHTML,$,y.inspection,f.inspectionType);n&&(fe(n),console.log(n)),w(),V(b.event,x),lt()}});document.addEventListener("keyup",e=>{e.key===" "&&(e.preventDefault(),!e.repeat&&(y.timerPhase===1&&et(),y.timerPhase===2&&(nt(),st())))});function ee(e,n){const o=document.getElementById(e),l=document.querySelectorAll(`.${n}`);if(!o||l.length===0)return;const s=`visibility-${e}`,r=localStorage.getItem(s);r&&(o.value=r);function i(){const m=o.value==="show";l.forEach(g=>{g.style.display=m?"":"none"}),localStorage.setItem(s,o.value)}o.addEventListener("change",i),i()}ee("toggle-scramble-visualizer","panel-cube");ee("toggle-statistics","right-sidebar");ee("toggle-session-history","left-sidebar");ee("toggle-scramble-text","scramble-container");ee("toggle-penalty-bar","penalty-bar");ee("toggle-average-preview","main-footer");const rt=document.getElementById("settingsOverlay"),nn=document.getElementById("settingsBtn"),on=document.getElementById("closeSettings");nn.addEventListener("click",()=>{rt.classList.add("open")});on.addEventListener("click",()=>{rt.classList.remove("open")});
